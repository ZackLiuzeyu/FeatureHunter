% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fh_gbm.R
\name{fh_gbm_lasso_best}
\alias{fh_gbm_lasso_best}
\title{LASSO + GBM (best via caret tuning)}
\usage{
fh_gbm_lasso_best(
  train_exp,
  train_labels,
  test_exp,
  labels_list,
  lassogene,
  fold = 10,
  cutoff = c(0.25, 0.5, 0.75),
  cores = NULL,
  auto_th_method = "auto",
  auto_imbalance_thresh = 0.35,
  auto_pr_vs_roc_gate = 0.5,
  collector = collector
)
}
\arguments{
\item{train_exp}{Training expression matrix (rows = samples, columns = genes).}

\item{train_labels}{Training labels (convertible to 0/1).}

\item{test_exp}{List of test sets: the 1st element = validation set B, others = C/D/….}

\item{labels_list}{List of label tables (A=1, B=2, …; column 1 = sample ID, column 2 = label).}

\item{lassogene}{Character vector of genes selected by LASSO.}

\item{fold}{Integer; folds for caret cross-validation (default 10).}

\item{cutoff}{Fixed cutoff thresholds; default \code{c(0.25, 0.5, 0.75)}.}

\item{cores}{Number of CPU cores for parallel tuning with caret/doParallel.}

\item{auto_th_method}{Auto threshold method: \code{"youden"} / \code{"f1"} / \code{"auto"}.
With \code{"auto"}, \code{decide_threshold_method()} will pick the strategy.}

\item{auto_imbalance_thresh}{Imbalance threshold for \code{decide_threshold_method()} (default 0.35).}

\item{auto_pr_vs_roc_gate}{PR-vs-ROC advantage ratio gate for \code{decide_threshold_method()} (default 0.5).}

\item{collector}{Optional environment; if supplied, each cutoff’s results are written into it
via \code{.fh_collect()}.}
}
\value{
An invisible list with four elements:
\itemize{
\item \code{acc}     — named numeric vectors of accuracy per dataset
\item \code{recall}  — named numeric vectors of recall  per dataset
\item \code{fs}      — named numeric vectors of F1      per dataset
\item \code{summary} — lists of data.frames of predictions per dataset
}
If \code{collector} is provided, results are also written there. Use
\code{fh_as_lists(collector)} to convert it into plain lists.
}
\description{
Fit a GBM (Bernoulli) on LASSO-selected features. Hyper-parameters are
tuned via caret CV; a probability cutoff is then chosen on validation set B
and merged with fixed cutoffs for evaluation on A/B/C/... datasets.
}
\examples{
\dontrun{
# assume 'collector <- new.env()'
fh_gbm_lasso_best(
  train_exp    = train_exp,
  train_labels = train_labels,
  test_exp     = list(exp_list[[2]], exp_list[[3]], exp_list[[4]]),
  labels_list  = labels_list,
  lassogene    = lassogene,
  fold         = 10,
  cutoff       = c(0.25, 0.5, 0.75),
  auto_th_method = "auto",
  auto_imbalance_thresh = 0.35,
  auto_pr_vs_roc_gate   = 0.5,
  collector    = collector
)
}
}
