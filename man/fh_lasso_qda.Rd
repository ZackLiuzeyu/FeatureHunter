% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fh_qda.R
\name{fh_lasso_qda}
\alias{fh_lasso_qda}
\title{LASSO + Quadratic Discriminant Analysis (QDA) Interface}
\usage{
fh_lasso_qda(
  train_exp,
  train_labels,
  test_exp,
  labels_list,
  lassogene,
  fold,
  cutoff = c(0.25, 0.5, 0.75),
  auto_th_method = "auto",
  auto_imbalance_thresh = 0.35,
  auto_pr_vs_roc_gate = 0.5,
  collector = collector
)
}
\arguments{
\item{train_exp}{Training expression matrix (samples x features).}

\item{train_labels}{Binary vector or factor of training labels (0/1).}

\item{test_exp}{A list: first element is validation set B; remaining elements are test sets C/D/…}

\item{labels_list}{A list of label data.frames (A=1, B=2, C=3, …) used for dataset alignment.}

\item{lassogene}{Character vector of LASSO-selected feature names.}

\item{fold}{Integer; only used for labeling in result keys (not used in computation).}

\item{cutoff}{Numeric vector of thresholds (default = c(0.25, 0.5, 0.75)); merged with auto threshold from B.}

\item{auto_th_method}{Auto threshold method: \code{"youden"} / \code{"f1"} / \code{"auto"}.
With \code{"auto"}, \code{decide_threshold_method()} is called to adaptively select
based on class imbalance and PR vs ROC performance; otherwise the specified method is used.}

\item{auto_imbalance_thresh}{Imbalance threshold for \code{decide_threshold_method()} (default 0.35).}

\item{auto_pr_vs_roc_gate}{PR-vs-ROC advantage ratio gate for \code{decide_threshold_method()} (default 0.5).}

\item{collector}{(optional) environment collector; if supplied, results for each cutoff are written into it.}
}
\value{
Returns a \code{collector} environment containing four fields:
\itemize{
\item \code{all_result_summary}: predicted result data.frames for each dataset
\item \code{all_result_acc}: accuracy values for each dataset
\item \code{all_result_recall}: recall values for each dataset
\item \code{all_result_FS}: F1 scores for each dataset
}
Use \code{fh_as_lists(collector)} to convert into plain R lists.
}
\description{
Applies LASSO-selected features (\code{lassogene}) to filter the expression matrix,
then trains a \code{MASS::qda} model.
The classification threshold is selected on validation set B (via \code{"f1"}, \code{"youden"}, or \code{"auto"}),
merged with fixed cutoffs, and used to evaluate F1 / Accuracy / Recall across datasets A/B/C/D…
Results are written into the \code{collector} environment.
}
\examples{
\dontrun{
collector <- .fh_new_collector()
fh_lasso_qda(
  train_exp       = train_exp,
  train_labels    = train_labels,
  test_exp        = list(exp_list[[2]], exp_list[[3]], exp_list[[4]]),  # B / C / D
  labels_list     = labels_list,
  lassogene       = lassogene,
  fold            = 10,
  cutoff          = c(0.25, 0.5, 0.75),
  auto_th_method  = "auto",
  collector       = collector
)
results <- fh_as_lists(collector)
str(results$all_result_acc)
}

}
