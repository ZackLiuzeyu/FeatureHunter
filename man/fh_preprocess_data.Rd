% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocessing.R
\name{fh_preprocess_data}
\alias{fh_preprocess_data}
\title{Preprocess Expression Data (log transform + reference scaling) and Split Train/Test}
\usage{
fh_preprocess_data(
  exp_list,
  labels_list,
  exp_files,
  train_exp_name,
  ref_index = 1,
  include_ref = TRUE,
  align = c("exact", "intersect")
)
}
\arguments{
\item{exp_list}{list of matrices/data.frames. Each element is a dataset (rows = samples, cols = genes).}

\item{labels_list}{list of data.frames (or a single data.frame). Each element has two columns: \code{sample_id}, \code{label}.}

\item{exp_files}{character vector. File names corresponding to \code{exp_list}, used for naming and reporting.}

\item{train_exp_name}{character. The file name of the training set (must exist in \code{exp_files}).}

\item{ref_index}{integer. Index of the reference dataset (e.g., 1 = first dataset).}

\item{include_ref}{logical. Whether to z-score the reference set itself (default = TRUE).}

\item{align}{character. Column alignment strategy: \code{"exact"} (strict match) or \code{"intersect"} (intersect with reference).}
}
\value{
list A list containing:
\itemize{
\item \code{pos_rate_summary} — positive label proportion summary (overall + per dataset)
\item \code{log_report} — dataset-wise log transform decisions and summaries
\item \code{scale_report} — reference scaling report
\item \code{exp_list} — processed (log + scaled) expression matrices
\item \code{train_exp} — training set expression matrix
\item \code{test_exp} — named list of test sets (named by \code{exp_files})
}
}
\description{
This function wraps the preprocessing pipeline:
\enumerate{
\item Compute positive label proportions (overall and per dataset).
\item Auto-detect and apply \code{log2(x+1)} transform for each dataset in \code{exp_list}.
\item Standardize all datasets using reference set mean/variance
(supporting column alignment by \code{"exact"} or \code{"intersect"}).
\item Split data into training and test sets according to \code{train_exp_name}.
}
}
