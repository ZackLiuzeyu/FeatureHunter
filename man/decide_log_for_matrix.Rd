% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{decide_log_for_matrix}
\alias{decide_log_for_matrix}
\title{log / Decide whether a matrix needs log transformation}
\usage{
decide_log_for_matrix(
  mat,
  force = c("auto", "always", "never"),
  integer_prop_threshold = 0.995,
  mean_threshold = 1,
  max_threshold = 100,
  tol = 1e-08,
  q_hi_prob = 0.99,
  q_hi_threshold = 20,
  frac_nonint_threshold = 0.2
)
}
\arguments{
\item{mat}{A matrix or data frame containing numeric values to be tested.}

\item{force}{\verb{"auto"``"always"``"never"} \code{"auto"}
\code{"auto"}
\code{"always"} log
\code{"never"} log
Mode for forcing decision, one of \code{"auto"}, \code{"always"}, \code{"never"} (default \code{"auto"}):
\code{"auto"}: automatically decide based on heuristics
\code{"always"}: always assume log transformation is needed
\code{"never"}: never apply log transformation}

\item{integer_prop_threshold}{(0.995)
Proportion threshold for integer-like values (default 0.995).
If the proportion of near-integers exceeds this, data are likely raw counts.}

\item{mean_threshold}{(1)
Mean threshold (default 1). The overall mean must exceed this to qualify as counts.}

\item{max_threshold}{(100)
Maximum value threshold (default 100). Large maximum values support the count-like hypothesis.}

\item{tol}{(1e-8)
Tolerance (default 1e-8). Used to decide whether a value is close enough to an integer.}

\item{q_hi_prob}{(0.99)
"log"
Quantile probability (default 0.99). Used to estimate the upper tail of the distribution for log-likeness.}

\item{q_hi_threshold}{(20)
log
Threshold for the high quantile (default 20). If below this, data are consistent with log scale.}

\item{frac_nonint_threshold}{(0.2)
log
Fraction of non-integer values required (default 0.2).
Ensures data are not purely counts and thus may be log-transformed.}
}
\value{
\code{need_log} log
\code{is_count}
\code{is_logged} log
Returns a list with three logical elements:
\code{need_log}: whether log transformation is needed
\code{is_count}: whether data are count-like
\code{is_logged}: whether data are already log-like
}
\description{
It heuristically decides whether the input matrix (or data frame)
should be log-transformed, based on whether the data resemble raw counts
or already log-transformed values.
}
