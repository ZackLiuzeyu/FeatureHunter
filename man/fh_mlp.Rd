% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fh_mlp.R
\name{fh_mlp}
\alias{fh_mlp}
\title{MLP Grid Search Runner (regularized & stabilized)}
\usage{
fh_mlp(
  train_exp,
  train_labels,
  test_exp,
  epochselecti = 50,
  batchsize_grid = "auto",
  learningrate_grid = c(0.001, 0.005, 0.01, 0.05),
  dropoutrate_grid = c(0.25, 0.5, 0.75),
  cutoff_grid = c(0.25, 0.5, 0.75),
  imbalance_thresh = 0.35,
  auto_th_method = "auto",
  early_patience = 8,
  seed = seed,
  labels_list = labels_list,
  collector = NULL,
  standardize = FALSE,
  hidden_units = c(32L, 16L, 8L),
  activation = "relu",
  use_batchnorm = TRUE,
  l2 = 1e-04,
  gaussian_noise_sd = 0,
  min_lr = 1e-05,
  plateau_factor = 0.5,
  plateau_patience = 4
)
}
\arguments{
\item{train_exp}{Training expression matrix}

\item{train_labels}{Training labels (0/1 or binary factor)}

\item{test_exp}{List: first element = validation set B, others = test sets C/D/â€¦}

\item{epochselecti}{Number of training epochs}

\item{batchsize_grid}{Batch size grid; auto-generated if "auto"}

\item{learningrate_grid}{Learning rate grid}

\item{dropoutrate_grid}{Dropout rate grid}

\item{cutoff_grid}{Cutoff grid (merged with auto thresholds)}

\item{imbalance_thresh}{Imbalance threshold for deciding class weighting}

\item{auto_th_method}{Thresholding method for the auto threshold on B:
one of \code{"youden"}, \code{"f1"}, \code{"auto"} (default).
If "auto", the method is decided by \code{decide_threshold_method()}.}

\item{early_patience}{Patience for early stopping (default 8)}

\item{seed}{Random seed}

\item{labels_list}{Label list (for \code{get_labels_for_matrix()})}

\item{collector}{(optional) Environment collector; if supplied, stores results into it}

\item{standardize}{Logical; standardize by train-set mean/sd (default TRUE)}

\item{hidden_units}{Integer vector; sizes of hidden layers (default c(32,16,8))}

\item{activation}{Activation for hidden layers (default "relu")}

\item{use_batchnorm}{Logical; add BatchNorm after each Dense (default TRUE)}

\item{l2}{Numeric; L2 kernel regularization (default 1e-4)}

\item{gaussian_noise_sd}{Numeric; std of input GaussianNoise (default 0)}

\item{min_lr}{Numeric; floor learning rate for ReduceLROnPlateau (default 1e-5)}

\item{plateau_factor}{Numeric; LR decay factor on plateau (default 0.5)}

\item{plateau_patience}{Integer; epochs to wait before LR reduce (default 4)}
}
\value{
Invisible NULL or a list of result containers if no collector is provided.
}
\description{
Grid search MLP hyperparameters (learning rate, batch size, dropout, etc.),
pick thresholds on validation set B using an automatic method selector
(merged with fixed cutoff values), and evaluate F1 / Accuracy / Recall on
datasets A/B/C/D... Results are stored into
\code{all_result_FS}, \code{all_result_acc}, \code{all_result_recall},
\code{all_result_summary}.

Includes stronger regularization and training stabilization:
\itemize{
\item Standardize features with train-set mean/sd (shared to val/test)
\item Batch Normalization (toggle via \code{use_batchnorm})
\item L2 kernel regularization (\code{l2})
\item Gaussian input noise (\code{gaussian_noise_sd})
\item ReduceLROnPlateau + EarlyStopping
}
}
\details{
\itemize{
\item Validation set B is always \code{test_exp[[1]]}.
\item Auto thresholding calls \code{decide_threshold_method()} to choose between
"youden" and "f1" when \code{auto_th_method="auto"}, then applies
\code{choose_threshold()} on B to obtain the numeric cutoff.
\item Each model key includes cutoff, learning rate, batch size, epoch, and dropout.
}
}
