% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fh_stepwise_lr.R
\name{fh_stepwise_lr}
\alias{fh_stepwise_lr}
\title{Stepwise Logistic Regression with AIC}
\usage{
fh_stepwise_lr(
  train_exp,
  train_labels,
  test_exp,
  labels_list,
  cutoff = c(0.25, 0.5, 0.75),
  auto_th_method = "auto",
  auto_imbalance_thresh = 0.35,
  auto_pr_vs_roc_gate = 0.5,
  collector = collector
)
}
\arguments{
\item{train_exp}{data.frame. Training expression matrix (rows = samples, columns = features).}

\item{train_labels}{vector. Binary labels for the training set (0/1 or convertible).}

\item{test_exp}{list. External expression matrices; the first is validation set B, then C/D/….}

\item{labels_list}{list. Label data.frames corresponding to datasets (A = 1, B = 2, …; col1 = ID, col2 = label).}

\item{cutoff}{numeric. Fixed cutoff thresholds (default \code{c(0.25, 0.5, 0.75)}); merged with the auto threshold from set B.}

\item{auto_th_method}{character. \code{"youden"} / \code{"f1"} / \code{"auto"}.
With \code{"auto"}, \code{decide_threshold_method()} is used to pick a strategy
based on class imbalance and PR-vs-ROC performance.}

\item{auto_imbalance_thresh}{numeric. Imbalance threshold passed to \code{decide_threshold_method()} (default 0.35).}

\item{auto_pr_vs_roc_gate}{numeric. PR-vs-ROC advantage ratio gate for \code{decide_threshold_method()} (default 0.5).}

\item{collector}{environment (optional). If supplied, each cutoff’s results are written
into it via \code{.fh_collect()}.}
}
\value{
Invisibly returns a list with four elements:
\itemize{
\item \code{acc}: named vectors of accuracy across datasets per key
\item \code{recall}: named vectors of recall across datasets per key
\item \code{fs}: named vectors of F1 across datasets per key
\item \code{summary}: lists of per-dataset prediction data.frames per key
}
If \code{collector} is provided, results are also written into it using the same keys.
}
\description{
Forward stepwise logistic regression using AIC for feature selection.
After training, a threshold is chosen on validation set B (either a fixed
method: "youden"/"f1", or auto via \code{decide_threshold_method()}),
merged with fixed cutoffs, and evaluated on A/B/C/… datasets to compute
F1/Accuracy/Recall. If a \code{collector} environment is supplied, results
are written into it via \code{.fh_collect()}; results are also accumulated
locally and returned invisibly.
}
\examples{
\dontrun{
# initialize a collector environment
collector <- new.env(parent = emptyenv())

fh_stepwise_logistic(
  train_exp    = train_exp,
  train_labels = train_labels,
  test_exp     = list(exp_list[[2]], exp_list[[3]], exp_list[[4]]), # B/C/D
  labels_list  = labels_list,
  cutoff       = c(0.25, 0.5, 0.75),
  collector    = collector
)
}

}
